# trivy-cve-scan
Scan multiple Docker images with [Trivy](https://github.com/aquasecurity/trivy) for a specific CVE (for example, Log4j CVE-2021-44228).

### Usage example

1. Install latest Trivy from https://github.com/aquasecurity/trivy/releases
2. Identify the list of your Docker images, for example to dump the list of all (!) images used in your K8s cluster:
```
# thanks to https://medium.com/linkbynet/cve-2021-44228-finding-log4j-vulnerable-k8s-pods-with-bash-trivy-caa10905744d
kubectl get pods -o jsonpath='{range .items[*]}{.spec.containers[*].image}{" "}' | tr " " "\n" | sort -u > images.txt
```
3. Scan all of these images for the vulnerability:
```
./trivy_cve_scan.sh CVE-2021-44228 < images.txt
```
4. Decide what to do with it - depends on your service's configuration, if the vulnerable library is actually used at runtime etc.
